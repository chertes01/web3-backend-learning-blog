# ğŸ“˜ Solidity å­¦ä¹ ç¬”è®° | ç¬¬äºŒè¯¾ï¼šç»“æ„ä½“ã€æ•°ç»„ä¸ msg.sender

## ğŸ”¹ è¯¾ç¨‹ç›®æ ‡

é€šè¿‡ä¸€ä¸ªå¯è®°å½•ä¿¡æ¯çš„ HelloWorld åˆçº¦ï¼Œå­¦ä¹ ï¼š

- âœ… `struct`ï¼ˆç»“æ„ä½“ï¼‰çš„å®šä¹‰ä¸åº”ç”¨
- âœ… ä½¿ç”¨ `array` (æ•°ç»„) å­˜å‚¨å¤šä¸ªç»“æ„ä½“
- âœ… æŒæ¡ `msg.sender` è®°å½•è°ƒç”¨è€…åœ°å€
- âœ… ç†è§£ `for` å¾ªç¯æŸ¥è¯¢ä¸ `push` æ–°å¢å…ƒç´ 

---

## ğŸ’» å®Œæ•´ä»£ç 

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

// è¿™æ˜¯ä¸€ä¸ªæ‰©å±•ç‰ˆçš„ HelloWorld åˆçº¦
// å®ƒå¯ä»¥å­˜å‚¨ä¸åŒç”¨æˆ·è®¾ç½®çš„ "hello" ä¿¡æ¯
contract HelloWorld {


// çŠ¶æ€å˜é‡ strVarï¼Œåˆå§‹å€¼ä¸º "hello world"
string strVar = "hello world";

// âœ… å®šä¹‰ç»“æ„ä½“ Infoï¼ŒåŒ…å« phrase(çŸ­è¯­)ã€id(ç¼–å·)ã€addr(è°ƒç”¨è€…åœ°å€)
struct Info {
    string phrase;
    uint256 id;
    address addr;
}

// âœ… å®šä¹‰ç»“æ„ä½“æ•°ç»„ infosï¼Œç”¨äºä¿å­˜æ‰€æœ‰ Info
Info[] infos;

// âœ… æŸ¥è¯¢å‡½æ•° sayHelloWorld
// æ ¹æ®ä¼ å…¥çš„ id åœ¨ infos ä¸­æŸ¥è¯¢ phraseï¼Œå¦åˆ™è¿”å›é»˜è®¤ strVar
function sayHelloWorld(uint256 _id) public view returns(string memory) {
    // for å¾ªç¯éå† infos æ•°ç»„
    for (uint256 i = 0; i < infos.length; i++) {
        if (infos[i].id == _id) {
            // å¦‚æœæ‰¾åˆ°åŒ¹é… idï¼Œè°ƒç”¨ addinfo æ‹¼æ¥åè¿”å›
            return addinfo(infos[i].phrase);
        }
    }
    // å¦‚æœæœªæ‰¾åˆ°ï¼Œè¿”å› strVar æ‹¼æ¥ç»“æœ
    return addinfo(strVar);
}

// âœ… è®¾ç½®å‡½æ•° setHelloWorld
// å°†å¤–éƒ¨ä¼ å…¥çš„ phrase å’Œ id å°è£…ä¸º Info ç»“æ„ä½“ï¼Œå¹¶æ·»åŠ åˆ° infos æ•°ç»„
function setHelloWorld(string memory newstrVar, uint _id) public {
    // åˆ›å»º Info ç»“æ„ä½“ï¼Œmsg.sender ä¸ºè°ƒç”¨è€…åœ°å€
    Info memory info = Info(newstrVar, _id, msg.sender);
    // å°† info æ·»åŠ åˆ° infos æ•°ç»„
    infos.push(info);
}

// âœ… å†…éƒ¨å‡½æ•° addinfo
// æ‹¼æ¥ä¼ å…¥å­—ç¬¦ä¸²å’Œå›ºå®šåç¼€
function addinfo(string memory HelloWorldstr) internal pure returns(string memory) {
    return string.concat(HelloWorldstr, ",from Von's Smart Contract");
}

}
```

---

## ğŸ” æ–°çŸ¥è¯†ç‚¹è§£æ

#### 1ï¸âƒ£ `struct`ï¼ˆç»“æ„ä½“ï¼‰
> **ç”¨é€”**ï¼šè‡ªå®šä¹‰å¤åˆæ•°æ®ç±»å‹ï¼Œå°†ä¸åŒå˜é‡å°è£…ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„ `struct` æˆ– `object`ã€‚

```solidity
struct Info {
    string phrase;
    uint256 id;
    address addr;
}
```
- `phrase`: å­—ç¬¦ä¸²çŸ­è¯­ã€‚
- `id`: æ— ç¬¦å·æ•´æ•°ï¼Œç”¨ä½œå”¯ä¸€æ ‡è¯†ã€‚
- `addr`: ä»¥å¤ªåŠåœ°å€ï¼ˆ20å­—èŠ‚ï¼‰ï¼Œç”¨äºè®°å½•è°ƒç”¨è€…ã€‚

#### 2ï¸âƒ£ `Info[] infos;` (æ•°ç»„)
> **å®šä¹‰**ï¼šä¸€ä¸ªåŠ¨æ€æ•°ç»„ `infos`ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª `Info` ç»“æ„ä½“ã€‚

é€šè¿‡ `infos.push(info)` å¯ä»¥å‘æ•°ç»„æœ«å°¾æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ ã€‚

#### 3ï¸âƒ£ `msg.sender`
> **å®šä¹‰**ï¼šSolidity å†…ç½®çš„å…¨å±€å˜é‡ï¼Œå®ƒä»£è¡¨**è°ƒç”¨å½“å‰å‡½æ•°çš„è´¦æˆ·åœ°å€**ã€‚

**å¸¸ç”¨åœºæ™¯**ï¼š
- **èº«ä»½è®°å½•**ï¼šå¦‚æ­¤å¤„çš„ `Info` ç»“æ„ä½“ï¼Œè®°å½•æ˜¯è°åˆ›å»ºäº†è¿™æ¡ä¿¡æ¯ã€‚
- **æƒé™æ§åˆ¶**ï¼šåˆ¤æ–­ `msg.sender` æ˜¯å¦ä¸ºåˆçº¦çš„ç®¡ç†å‘˜ï¼ˆownerï¼‰ã€‚
- **èµ„é‡‘è½¬ç§»**ï¼šåœ¨è½¬è´¦æ—¶ç¡®å®šèµ„é‡‘çš„å‘é€æ–¹ã€‚

#### 4ï¸âƒ£ `for` å¾ªç¯
> **ç”¨é€”**ï¼šéå†æ•°ç»„æˆ–å…¶ä»–å¯è¿­ä»£çš„æ•°æ®ç»“æ„ã€‚

```solidity
for (uint256 i = 0; i < infos.length; i++) { ... }
```
è¿™æ˜¯ Solidity ä¸­æ ‡å‡†çš„ `for` å¾ªç¯è¯­æ³•ï¼Œç”¨äºéå† `infos` æ•°ç»„ï¼Œé€šè¿‡ç´¢å¼• `i` è®¿é—®æ¯ä¸ªå…ƒç´ ã€‚

#### 5ï¸âƒ£ `memory` å…³é”®å­—
> **ç”¨é€”**ï¼š`memory` ç”¨äºå£°æ˜å˜é‡åªåœ¨å‡½æ•°æ‰§è¡ŒæœŸé—´ä¸´æ—¶å­˜åœ¨ï¼Œä¸ä¼šæ°¸ä¹…ä¿å­˜åœ¨åŒºå—é“¾ä¸Šã€‚

```solidity
Info memory info = Info(newstrVar, _id, msg.sender);
```
è¿™é‡Œåˆ›å»ºçš„ `info` å˜é‡å°±æ˜¯ä¸€ä¸ªå†…å­˜å˜é‡ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•åå®ƒæ‰€å ç”¨çš„ç©ºé—´å°±ä¼šè¢«é‡Šæ”¾ã€‚

**æ•°æ®ä½ç½®å¯¹æ¯”**ï¼š
- `storage`ï¼šæ°¸ä¹…å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šï¼Œæ˜¯çŠ¶æ€å˜é‡çš„é»˜è®¤ä½ç½®ï¼Œè¯»å†™ä¼šæ¶ˆè€—å¤§é‡ Gasã€‚
- `memory`ï¼šå‡½æ•°å†…éƒ¨çš„ä¸´æ—¶å˜é‡ï¼Œå‡½æ•°æ‰§è¡Œç»“æŸå³é”€æ¯ï¼ŒGas æˆæœ¬è¾ƒä½ã€‚
- `calldata`ï¼šå¤–éƒ¨å‡½æ•°å‚æ•°çš„å­˜å‚¨ä½ç½®ï¼Œæ˜¯åªè¯»çš„ï¼ŒGas æˆæœ¬æœ€ä½ã€‚

---

## ğŸ”§ è°ƒç”¨å›¾ç¤ºï¼ˆé€»è¾‘æµç¨‹ï¼‰

1.  **éƒ¨ç½²åˆçº¦**
    - `strVar` çš„åˆå§‹å€¼è¢«è®¾ä¸º `"hello world"`ã€‚
    - `infos` æ•°ç»„è¢«åˆå§‹åŒ–ä¸ºç©º `[]`ã€‚

2.  **è°ƒç”¨ `setHelloWorld("ä½ å¥½", 1)`**
    - åœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºä¸€ä¸ª `Info` å†…å­˜å˜é‡ï¼š`Info(phrase="ä½ å¥½", id=1, addr=è°ƒç”¨è€…åœ°å€)`ã€‚
    - é€šè¿‡ `infos.push()` å°†è¿™ä¸ª `Info` ç»“æ„ä½“å­˜å…¥ `infos` çŠ¶æ€å˜é‡æ•°ç»„ä¸­ã€‚
    - **æ¶ˆè€— Gas**ï¼Œå› ä¸ºè¿™ä¸ªæ“ä½œä¿®æ”¹äº†åŒºå—é“¾çš„çŠ¶æ€ï¼ˆå†™å…¥äº†æ•°æ®ï¼‰ã€‚

3.  **è°ƒç”¨ `sayHelloWorld(1)`**
    - `for` å¾ªç¯éå† `infos` æ•°ç»„ã€‚
    - å½“ `i=0` æ—¶ï¼Œæ‰¾åˆ° `infos[0].id == 1`ï¼Œæ¡ä»¶åŒ¹é…ã€‚
    - è¿”å› `addinfo("ä½ å¥½")` çš„ç»“æœï¼š`"ä½ å¥½,from Von's Smart Contract"`ã€‚
    - è¿™æ˜¯ä¸€ä¸ª `view` å‡½æ•°ï¼Œåªè¯»å–çŠ¶æ€ï¼Œä¸æ¶ˆè€— Gasï¼ˆåœ¨é“¾ä¸‹è°ƒç”¨æ—¶ï¼‰ã€‚

4.  **è°ƒç”¨ `sayHelloWorld(999)`**
    - `for` å¾ªç¯éå†æ•´ä¸ª `infos` æ•°ç»„ï¼Œä½†æ²¡æœ‰æ‰¾åˆ° `id` ä¸º `999` çš„å…ƒç´ ã€‚
    - å‡½æ•°æ‰§è¡Œåˆ°æœ€åï¼Œè¿”å›é»˜è®¤å€¼ `addinfo(strVar)` çš„ç»“æœï¼š`"hello world,from Von's Smart Contract"`ã€‚

---

## ğŸ“š æœ¬è¯¾è¡¥å……ï¼šSolidity å¸¸ç”¨æ•°æ®ç±»å‹

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- |
| `uint` / `uint256` | æ— ç¬¦å·æ•´æ•°ï¼ˆå¸¸ç”¨ä½œ IDã€æ•°é‡ï¼‰ | `uint256 x = 1;` |
| `int` / `int256` | æœ‰ç¬¦å·æ•´æ•° | `int y = -5;` |
| `bool` | å¸ƒå°”ç±»å‹ï¼ˆ`true` æˆ– `false`ï¼‰ | `bool flag = true;` |
| `string` | å­—ç¬¦ä¸² | `string name = "Von";` |
| `address` | ä»¥å¤ªåŠåœ°å€ | `address owner = msg.sender;` |
| `struct` | ç»“æ„ä½“ | `struct Info {...}` |
| `array` | æ•°ç»„ | `uint[] nums;` |
| `mapping` | é”®å€¼æ˜ å°„è¡¨ | `mapping(address => uint) balances;` |

---

## âœ… æœ¬è¯¾æ€»ç»“

- âœ… å­¦ä¼šäº†å¦‚ä½•å®šä¹‰å’Œå®ä¾‹åŒ–**ç»“æ„ä½“ `struct`**ã€‚
- âœ… æŒæ¡äº†å¦‚ä½•ä½¿ç”¨**æ•°ç»„ `array`** æ¥å­˜å‚¨å’Œç®¡ç†ä¸€ç»„å¤æ‚æ•°æ®ã€‚
- âœ… ç†è§£äº† `msg.sender` çš„å«ä¹‰ï¼Œå¹¶ç”¨å®ƒæ¥è¿½è¸ª**å‡½æ•°è°ƒç”¨è€…**ã€‚
- âœ… å®è·µäº†é€šè¿‡ `for` å¾ªç¯**éå†æ•°ç»„**è¿›è¡Œæ•°æ®æŸ¥è¯¢ã€‚
- âœ… è¿›ä¸€æ­¥åŒºåˆ†äº† `memory` å’Œ `storage` ä¸¤ç§æ•°æ®ä½ç½®ã€‚

---

## ğŸ¯ ç»ƒä¹ æ‹“å±•

1.  ä¿®æ”¹ `sayHelloWorld` å‡½æ•°ï¼Œå¦‚æœæ‰¾åˆ°å¯¹åº” `id`ï¼Œè®©å®ƒåŒæ—¶è¿”å› `phrase` å’Œ `addr`ã€‚ï¼ˆæç¤ºï¼šå‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼‰ã€‚
2.  åœ¨ `setHelloWorld` å‡½æ•°ä¸­æ·»åŠ  `require` è¯­å¥ï¼Œç¡®ä¿æ–°æ·»åŠ çš„ `_id` ä¸ä¸æ•°ç»„ä¸­å·²æœ‰çš„ `id` é‡å¤ã€‚
3.  ï¼ˆæŒ‘æˆ˜ï¼‰ä¸ºåˆçº¦æ·»åŠ ä¸€ä¸ª `deleteInfo(uint _id)` å‡½æ•°ï¼Œç”¨äºåˆ é™¤æŒ‡å®š `id` çš„å…ƒç´ ã€‚